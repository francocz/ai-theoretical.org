=== BACKUP ATIndexPage ===

--- contentHtml ---
contentHtml
	^ '<div class="container">
    <header>
        <div class="top-subtitle">Human-AI Theoretical Laboratory</div>
        <h1>AI-Theoretical</h1>
        <hr>
    </header>

    <div class="manifesto-grid">
        <div class="manifesto-label">
            <a href="manifesto.html">Manifesto</a>
            <a href="editorial-principles.html">Editorial framework</a>
            <a href="ai-editorial-prompt.html">AI editorial prompt</a>
            <a href="invite.html">Invitation to participate</a>
            <a href="submit.html">Submit a paper</a>
        </div>
        <div>
            <div class="manifesto-quote">
                "This platform collects and publishes scholarly papers openly co-authored by humans and frontier AI models. We experiment with new forms of knowledge production to reflect on authorship and epistemology in the age of synthetic intelligence."
            </div>
        </div>
    </div>
    <hr>

    <div class="search-section">
        <div class="search-box">
            <input type="text" id="searchInput" class="search-input" placeholder="Search papers by title, author, abstract, or keywords...">
        </div>
        <div class="search-filters">
            <select id="yearFilter" class="filter-select">
                <option value="">All Years</option>
            </select>
            <select id="authorFilter" class="filter-select">
                <option value="">All Authors</option>
            </select>
            <select id="aiFilter" class="filter-select">
                <option value="">All AI Models</option>
            </select>
        </div>
        <div id="searchStatus" class="search-results-count"></div>
    </div>

    <div id="repository"></div>
    
    ', self footer, '
</div>'

--- javascript ---
javascript
	^ '<script src="papers.js"></script>
<script>
    const repo = document.getElementById(''repository'');
    const searchInput = document.getElementById(''searchInput'');
    const yearFilter = document.getElementById(''yearFilter'');
    const authorFilter = document.getElementById(''authorFilter'');
    const aiFilter = document.getElementById(''aiFilter'');
    const searchStatus = document.getElementById(''searchStatus'');
    
    let allPapers = [];

    function highlightText(text, query) {
        if (!query || !text) return text;
        const words = query.toLowerCase().split(/\s+/).filter(w => w.length > 2);
        if (words.length === 0) return text;
        const regex = new RegExp(`(${words.join(''|'')})`    , ''gi'');
        return text.replace(regex, ''<span class="highlight">$1</span>'');
    }

    function matchesPaper(paper, query) {
        if (!query) return true;
        const q = query.toLowerCase();
        const words = q.split(/\s+/).filter(w => w.length > 0);
        const searchable = `${paper.title} ${paper.author} ${paper.abstract || ''''} ${paper.ai_model || ''''}`.toLowerCase();
        return words.every(word => searchable.includes(word));
    }

    function filterPapers() {
        const query = searchInput.value.trim();
        const year = yearFilter.value;
        const author = authorFilter.value;
        const ai = aiFilter.value;

        let filtered = allPapers.filter(p => {
            if (!matchesPaper(p, query)) return false;
            if (year && !p.date?.includes(year)) return false;
            if (author && p.author !== author) return false;
            if (ai && p.ai_model !== ai) return false;
            return true;
        });

        renderPapers(filtered, query);
        updateStatus(filtered.length, allPapers.length);
    }

    function updateStatus(shown, total) {
        if (searchInput.value || yearFilter.value || authorFilter.value || aiFilter.value) {
            searchStatus.innerHTML = `Showing <strong>${shown}</strong> of ${total} papers <span class="clear-search" onclick="clearSearch()">Clear filters</span>`;
        } else {
            searchStatus.innerHTML = `<strong>${total}</strong> papers published`;
        }
    }

    function clearSearch() {
        searchInput.value = '''';
        yearFilter.value = '''';
        authorFilter.value = '''';
        aiFilter.value = '''';
        filterPapers();
    }

    function populateFilters() {
        const years = [...new Set(allPapers.map(p => p.date?.substring(0, 4)).filter(Boolean))].sort().reverse();
        const authors = [...new Set(allPapers.map(p => p.author).filter(Boolean))].sort();
        const ais = [...new Set(allPapers.map(p => p.ai_model).filter(Boolean))].sort();

        years.forEach(y => yearFilter.innerHTML += `<option value="${y}">${y}</option>`);
        authors.forEach(a => authorFilter.innerHTML += `<option value="${a}">${a}</option>`);
        ais.forEach(a => aiFilter.innerHTML += `<option value="${a}">${a}</option>`);
    }

    function renderPapers(papers, query = '''') {
        repo.innerHTML = papers.map((p, i) => {
            const title = highlightText(p.title, query);
            const author = highlightText(p.author, query);
            const abstract = highlightText(p.abstract, query);
            return `
            <article class="paper-entry">
                <h2 class="paper-title">${title}</h2>
                <div class="paper-meta">
                    By <strong>${author}</strong> & <span class="ai-tag">${p.ai_model}</span> | ${p.date} - ${p.pages} Pages
                </div>
                <div class="btn-group">
                    <a href="${p.pdf_file}" class="btn btn-black" download>Download PDF</a>
                    <button class="btn btn-white" onclick="toggle(''abs-${i}'')">Abstract</button>
                    ${p.ai_assessment ? `<button class="btn btn-white" onclick="toggle(''ass-${i}'')">AI Assessment</button>` : ``}
                    ${p.notes ? `<button class="btn btn-white" onclick="toggle(''notes-${i}'')">Notes</button>` : ``}
                </div>
                <div id="abs-${i}" class="abstract-panel">
                    <strong>Abstract:</strong><br><br>${abstract}
                </div>
                ${p.ai_assessment ? `
                <div id="ass-${i}" class="abstract-panel">
                    <strong>AI Editorial Assessment:</strong><br><br>
                    <pre style="white-space: pre-wrap; font-family: inherit;">${p.ai_assessment}</pre>
                </div>
                ` : ``}
                ${p.notes ? `
                <div id="notes-${i}" class="abstract-panel">
                    <strong>Notes on AI Collaboration:</strong><br><br>
                    <pre style="white-space: pre-wrap; font-family: inherit;">${p.notes}</pre>
                </div>
                ` : ``}
            </article>
        `}).join('''');
    }

    function toggle(id) { 
        document.getElementById(id).classList.toggle(''show''); 
    }

    function init() {
        if (typeof PAPERS_DATA === ''undefined'') return;
        allPapers = PAPERS_DATA;
        populateFilters();
        renderPapers(allPapers);
        updateStatus(allPapers.length, allPapers.length);

        searchInput.addEventListener(''input'', filterPapers);
        yearFilter.addEventListener(''change'', filterPapers);
        authorFilter.addEventListener(''change'', filterPapers);
        aiFilter.addEventListener(''change'', filterPapers);
    }

    window.onload = init;
</script>'

--- css ---
css
	^ ATStyles baseCss, String lf, ATStyles indexCss
